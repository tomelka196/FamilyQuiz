<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>We Love The World - Quiz</title>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDK v8 - Most stable for static hosting -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <style>
        body { font-family: 'Merriweather', serif; margin: 0; padding: 0; }
        .font-oswald { font-family: 'Oswald', sans-serif; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .timer-pulse { animation: pulse 1s ease-in-out infinite; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script>
        // Global app variable
        let app;
        
        // Wait for Firebase SDK to load
        window.addEventListener('load', function() {
            // Check if Firebase is loaded
            if (typeof firebase === 'undefined') {
                document.getElementById('root').innerHTML = '<div style="padding: 20px; text-align: center;"><h1>Chyba naƒç√≠t√°n√≠ Firebase / Firebase loading error</h1><p>Zkuste obnovit str√°nku / Try refreshing the page</p></div>';
                console.error('Firebase SDK failed to load');
                return;
            }

            // Firebase Configuration
            const firebaseConfig = {
                apiKey: "AIzaSyAA-7YU1mkJoyfp27egxLGeaZ9w-XlJsHk",
                authDomain: "familyquiz-7286e.firebaseapp.com",
                databaseURL: "https://familyquiz-7286e-default-rtdb.europe-west1.firebasedatabase.app",
                projectId: "familyquiz-7286e",
                storageBucket: "familyquiz-7286e.firebasestorage.app",
                messagingSenderId: "613041565722",
                appId: "1:613041565722:web:9fb4c6ae3b814b8bfaa1a3"
            };

            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            const database = firebase.database();
            const gameRef = database.ref('game');

        const CATEGORIES = [
            { id: 1, name: 'Geography & Landmarks', icon: 'üåç', type: 'knowledge', points: 10 },
            { id: 2, name: 'Music Through Decades', icon: 'üéµ', type: 'buzzer', points: 12 },
            { id: 3, name: 'Food & Traditions', icon: 'üçï', type: 'knowledge', points: 10 },
            { id: 4, name: 'Famous People', icon: 'üë•', type: 'knowledge', points: 10 },
            { id: 5, name: 'Movies & TV', icon: 'üé¨', type: 'buzzer', points: 15 },
            { id: 6, name: 'Nature & Animals', icon: 'üå≤', type: 'knowledge', points: 10 },
            { id: 7, name: 'History Highlights', icon: '‚è∞', type: 'knowledge', points: 10 },
            { id: 8, name: 'Sport & Champions', icon: '‚öΩ', type: 'knowledge', points: 10 }
        ];

        const QUESTIONS = {
            1: { // Geography
                1: { cz: 'Ve kter√© zemi se nach√°z√≠ Eiffelova vƒõ≈æ?', it: 'In quale paese si trova la Torre Eiffel?', answers: ['Francie / Francia', 'Nƒõmecko / Germania', 'It√°lie / Italia', '≈†panƒõlsko / Spagna'], correct: 0 },
                2: { cz: 'Vƒõƒçn√© mƒõsto na sedmi pahorc√≠ch, kde kdysi vl√°dli c√≠sa≈ôov√© a gladi√°to≈ôi bojovali v ar√©n√°ch. Kter√© mƒõsto to je?', it: 'La citt√† eterna su sette colli, dove imperatori governarono e gladiatori combatterono. Quale citt√† √®?', answers: ['At√©ny / Atene', '≈ò√≠m / Roma', 'Istanbul', 'K√°hira / Cairo'], correct: 1, hints: [{type:'image',content:'https://lh3.googleusercontent.com/d/1fN17ROTReni7sfi44IUou6StbzSXTlH6'},{type:'text',content:'üí° Nach√°z√≠ se v It√°lii'}] },
                3: { cz: 'Tento oce√°n je nejvƒõt≈°√≠ na planetƒõ, pokr√Ωv√° v√≠ce ne≈æ t≈ôetinu zemsk√©ho povrchu. Jak√Ω oce√°n to je?', it: 'Questo oceano √® il pi√π grande del pianeta, copre pi√π di un terzo della superficie terrestre. Quale oceano √®?', answers: ['Tich√Ω / Pacifico', 'Indick√Ω / Indiano', 'Atlantsk√Ω / Atlantico', 'Severn√≠ ledov√Ω / Artico'], correct: 0, hints: [{type:'text',content:'üí° Le≈æ√≠ mezi Amerikou a Asi√≠'},{type:'image',content:'https://lh3.googleusercontent.com/d/1o2kJPFS1U3XaUvoOUzAt04UfGIUtBfmI'}] },
                4: { cz: 'Vln√≠c√≠ se kopce, vinice a aleje cyp≈ôi≈°≈Ø. Odtud poch√°z√≠ slavn√© ƒçerven√© v√≠no z hrozn≈Ø Sangiovese. Kter√° italsk√° oblast je s touto krajinou spojen√°?', it: 'Colline ondulate, vigneti e viali di cipressi. Da qui proviene il famoso vino rosso dai vitigni Sangiovese. Quale regione italiana √® associata a questo paesaggio?', answers: ['Piemonte', 'Tosk√°nsko / Toscana', 'Sic√≠lie / Sicilia', 'Ben√°tsko / Veneto'], correct: 1, hints: [{type:'text',content:'üí° V√≠no se jmenuje Chianti'},{type:'image',content:'https://lh3.googleusercontent.com/d/1vfx5ov4HuJVptGK0IjJKX9wHfPczf9_x'}] },
                5: { cz: 'Tato hora, kter√° se tyƒç√≠ na hranici Nep√°lu a Tibetu, je naz√Ωv√°na "Matka bohynƒõ svƒõta". Jej√≠ vrchol dosahuje 8 849 metr≈Ø. Kter√° hora to je?', it: 'Questa montagna, che si erge al confine tra Nepal e Tibet, √® chiamata "Madre dea del mondo". La sua vetta raggiunge 8 849 metri. Quale montagna √®?', answers: ['K2', 'Mount Everest', 'Kilimand≈æ√°ro / Kilimangiaro', 'Mont Blanc'], correct: 1, hints: [{type:'text',content:'üí° Je to nejvy≈°≈°√≠ hora svƒõta'},{type:'image',content:'https://lh3.googleusercontent.com/d/1kp6xldPTHfQAdvSfm48J4XR2sJqGJEwy'}] },
                6: { cz: 'Kter√© jezero je nejhlub≈°√≠ na svƒõtƒõ a obsahuje 20% ve≈°ker√© sladk√© vody planety?', it: 'Quale lago √® il pi√π profondo al mondo e contiene il 20% di tutta l\'acqua dolce del pianeta?', answers: ['Bajkal', 'Tanganjika', 'Kaspick√© mo≈ôe', 'Viktoriino jezero'], correct: 0 }
            },
            2: { // Music
                1: { cz: 'Uh√°dnƒõte p√≠sniƒçku', it: 'Indovina la canzone', type: 'buzzer', visual: 'üëëüíÉ', answer: 'Dancing Queen (ABBA)', image: 'https://lh3.googleusercontent.com/d/19g1qQ2MbO6T7rbh2iA7lzE3TOZnBJR-F' },
                2: { cz: 'Uh√°dnƒõte p√≠sniƒçku', it: 'Indovina la canzone', type: 'buzzer', visual: 'üë•üèÜ', answer: 'We Are The Champions (Queen)', image: 'https://lh3.googleusercontent.com/d/1BRH8B9FeIm4StgdbdYUS41jz1Drk3zFa' },
                3: { cz: 'Uh√°dnƒõte p√≠sniƒçku', it: 'Indovina la canzone', type: 'buzzer', visual: 'üëñüë©', answer: 'Thriller (Michael Jackson)', image: 'https://lh3.googleusercontent.com/d/1HuNZOUk-POnrEFrokZZm_jRXNfqizStn' },
                4: { cz: 'Uh√°dnƒõte p√≠sniƒçku', it: 'Indovina la canzone', type: 'buzzer', visual: 'üêâ‚ö°‚õàÔ∏è', answer: 'Thunder (Imagine Dragons)', image: 'https://lh3.googleusercontent.com/d/1qOcxxo0DTPBXxMgBUTPf6hWH5moU2gsz' },
                5: { cz: 'Uh√°dnƒõte p√≠sniƒçku', it: 'Indovina la canzone', type: 'buzzer', visual: 'üìêüë§', answer: 'Shape of You (Ed Sheeran)', image: 'https://lh3.googleusercontent.com/d/1j4Vg86oe7NwlHuPOpbZCa2VP3_kJxI_Q' },
                6: { cz: 'Kter√° p√≠se≈à byla p≈ôehr√°na jako prvn√≠ v historii na Mezin√°rodn√≠ vesm√≠rn√© stanici ISS?', it: 'Quale canzone √® stata suonata per la prima volta nella storia sulla Stazione Spaziale Internazionale ISS?', answers: ['Space Oddity - David Bowie', 'Rocket Man - Elton John', 'Fly Me to the Moon - Frank Sinatra', 'Walking on the Moon - The Police'], correct: 0 }
            },
            3: { // Food
                1: { cz: 'Jak√° je hlavn√≠ p≈ô√≠sada v tradiƒçn√≠m italsk√©m rizotu?', it: 'Qual √® l\'ingrediente principale nel risotto italiano tradizionale?', answers: ['Brambory / Patate', 'R√Ω≈æe / Riso', 'Tƒõstoviny / Pasta', 'Polenta'], correct: 1 },
                2: { cz: 'Poch√°z√≠ ze zemƒõ vych√°zej√≠c√≠ho slunce, p≈ôipravuje se z r√Ω≈æe a syrov√Ωch ryb. Co to je?', it: 'Proviene dalla terra del sol levante, si prepara con riso e pesce crudo. Cos\'√®?', answers: ['Sushi', 'Ramen', 'Tempura', 'Sashimi'], correct: 0, hints: [{type:'text',content:'üí° J√≠ se h≈Ølkami'},{type:'image',content:'https://lh3.googleusercontent.com/d/1CfWs_qfzNySH2Fq3f8XOWGE3D8KUK3B5'}] },
                3: { cz: 'Zraje pod srpnov√Ωm sluncem a jeho v≈Ønƒõ napln√≠ celou chalupu. Kdy≈æ p≈ôijde ƒças, st√°v√° se z nƒõho tekut√Ω poklad ‚Äî ale jen pro ty trpƒõliv√©. Co vznik√° t√≠mto tradiƒçn√≠m zp≈Øsobem?', it: 'Matura sotto il sole di agosto e il suo profumo riempie tutta la casa di campagna. Quando arriva il momento, diventa un tesoro liquido ‚Äî ma solo per i pazienti. Cosa nasce in questo modo tradizionale?', answers: ['Povidla / Marmellata di prugne', 'Slivovice / Grappa di prugne', 'Hru≈°kovice / Grappa di pere', 'D≈æem / Confettura'], correct: 1, hints: [{type:'text',content:'üí° Obsahuje alkohol'},{type:'image',content:'https://lh3.googleusercontent.com/d/1x-HxmchEGs4AGtd9C_v_LdrukKFGKqYB'}] },
                4: { cz: 'Tvrd√Ω, dozr√°vaj√≠c√≠ s√Ωr s nezamƒõnitelnou chut√≠, kter√Ω nese chr√°nƒõn√© oznaƒçen√≠ p≈Øvodu. Zraje v srdci It√°lie a nese jm√©no sv√©ho kraje. Jak se jmenuje?', it: 'Formaggio duro, stagionato con un gusto inconfondibile, che porta la denominazione di origine protetta. Matura nel cuore dell\'Italia e porta il nome della sua regione. Come si chiama?', answers: ['Parmigiano Reggiano', 'Gorgonzola', 'Mozzarella', 'Grana Padano'], correct: 0, hints: [{type:'text',content:'üí° Strouh√° se na tƒõstoviny'},{type:'image',content:'https://lh3.googleusercontent.com/d/10sPQMLXLfRF88mHtK7DS5MD2gWKWTEmu'}] },
                5: { cz: 'Tento tradiƒçn√≠ ƒçesk√Ω pokrm se serv√≠ruje v den, kdy se v≈°ichni post√≠me, abychom veƒçer vidƒõli zlat√© pras√°tko. Skl√°d√° se z ≈æivoƒçicha ≈æij√≠c√≠ho ve vodƒõ s p≈ô√≠lohou sal√°tovou. Co je to?', it: 'Questo piatto tradizionale ceco si serve nel giorno in cui tutti digiunano per vedere il maialino d\'oro la sera. Si compone di un animale acquatico con contorno di insalata. Cos\'√®?', answers: ['Humr', 'Chobotnice', 'Kapr', 'Tu≈à√°k'], correct: 2, hints: [{type:'text',content:'üí° Je to sladkovodn√≠ ryba'},{type:'image',content:'https://lh3.googleusercontent.com/d/1uWiviULENkpqoppWAmaVz32mmnQvcIJR'}] },
                6: { cz: 'Kter√° potravina nikdy neskaz√≠ a byla nalezena jedl√° i v 3000 let star√Ωch egyptsk√Ωch hrobk√°ch?', it: 'Quale alimento non si deteriora mai ed √® stato trovato commestibile anche in tombe egizie di 3000 anni?', answers: ['Med', 'Su≈°en√© maso', 'Tvrd√Ω s√Ωr', 'Olivov√Ω olej'], correct: 0 }
            },
            4: { // Famous People
                1: { cz: 'Kdo namaloval Monu Lisu?', it: 'Chi ha dipinto la Gioconda?', answers: ['Michelangelo', 'Leonardo da Vinci', 'Raffaello', 'Caravaggio'], correct: 1 },
                2: { cz: 'Putoval peklem, oƒçistcem i r√°jem. Jeho ver≈°e z 14. stolet√≠ tvo≈ô√≠ jednu z nejvƒõt≈°√≠ch liter√°rn√≠ch pout√≠ v≈Øbec. Kdo je autorem t√©to cesty?', it: 'Ha viaggiato attraverso l\'inferno, il purgatorio e il paradiso. I suoi versi del XIV secolo formano uno dei pi√π grandi viaggi letterari di tutti i tempi. Chi √® l\'autore di questo viaggio?', answers: ['Dante Alighieri', 'Petrarca', 'Boccaccio', 'Manzoni'], correct: 0, hints: [{type:'text',content:'üí° Jeho jm√©no zaƒç√≠n√° D'},{type:'image',content:'https://lh3.googleusercontent.com/d/1SztwUyzGgD-MEwHvDysjL_i0b7GYeDAR'}] },
                3: { cz: 'Vedl svou zemi v dobƒõ rozdƒõlen√≠ a utrpen√≠. Sv√Ωm podpisem zmƒõnil osudy milion≈Ø a stal se symbolem boje za svobodu. Kdo byl t√≠mto americk√Ωm prezidentem?', it: 'Ha guidato il suo paese in un periodo di divisione e sofferenza. Con la sua firma ha cambiato il destino di milioni e √® diventato un simbolo della lotta per la libert√†. Chi era questo presidente americano?', answers: ['Thomas Jefferson', 'George Washington', 'Abraham Lincoln', 'Benjamin Franklin'], correct: 2, hints: [{type:'text',content:'üí° Jeho tv√°≈ô je na Mt. Rushmore'},{type:'image',content:'https://lh3.googleusercontent.com/d/1EMC8EgAlrBsMSTsAVavJTtrWnoqDo8Pt'}] },
                4: { cz: 'Tento slavn√Ω skladatel p≈ôi≈°el o sluch, p≈ôesto vytvo≈ôil d√≠la, kter√° dnes zn√° cel√Ω svƒõt. Kdo to byl?', it: 'Questo famoso compositore perse l\'udito, ma cre√≤ opere che oggi conosce tutto il mondo. Chi era?', answers: ['Mozart', 'Bach', 'Beethoven', 'Vivaldi'], correct: 2, hints: [{type:'text',content:'üí° Jeho 9. symfonie je hymnou EU'},{type:'image',content:'https://lh3.googleusercontent.com/d/1bBDxYmssy5iCP7FymJLcs7au3HpCFUu6'}] },
                5: { cz: 'Vƒõdec s nezamƒõniteln√Ωm vzhledem, kter√Ω nav≈ædy zmƒõnil pojet√≠ prostoru, ƒçasu i energie. Jeho slavn√° rovnice je zn√°m√°, ale jeho ≈æivot pln√Ω paradox≈Ø je≈°tƒõ v√≠ce. Kdo to byl?', it: 'Scienziato dall\'aspetto inconfondibile, che ha cambiato per sempre la concezione di spazio, tempo ed energia. La sua famosa equazione √® nota, ma la sua vita piena di paradossi ancora di pi√π. Chi era?', answers: ['Isaac Newton', 'Albert Einstein', 'Galileo Galilei', 'Stephen Hawking'], correct: 1, hints: [{type:'text',content:'üí° Dostal Nobelovu cenu za fyziku'},{type:'image',content:'https://lh3.googleusercontent.com/d/1FHuI9hQxTnx6bL5trkGYdkEO6czMeVaw'}] },
                6: { cz: 'Kter√Ω vƒõdec odm√≠tl nab√≠dku st√°t se prezidentem Izraele v roce 1952?', it: 'Quale scienziato rifiut√≤ l\'offerta di diventare presidente di Israele nel 1952?', answers: ['Albert Einstein', 'Niels Bohr', 'Enrico Fermi', 'Richard Feynman'], correct: 0 }
            },
            5: { // Movies
                1: { cz: 'Uh√°dnƒõte film', it: 'Indovina il film', type: 'buzzer', visual: 'üö¢‚ùÑÔ∏è', answer: 'Titanic', image: 'https://lh3.googleusercontent.com/d/1xeUquLRMucxea9In_xl0dhkiLzaFTKuU' },
                2: { cz: 'Uh√°dnƒõte postavu', it: 'Indovina il personaggio', type: 'buzzer', visual: '‚ö°üëìüßô‚Äç‚ôÇÔ∏è', answer: 'Harry Potter', image: 'https://lh3.googleusercontent.com/d/1QoTlP3rWK55_C2Y72G-zyZIijTCsSwFs' },
                3: { cz: 'Uh√°dnƒõte film', it: 'Indovina il film', type: 'buzzer', visual: 'üëπüßÖ', answer: 'Shrek', image: 'https://lh3.googleusercontent.com/d/1XDhsUSmlKgiJNhfG_3wb0QuGx3W4pkRV' },
                4: { cz: 'Uh√°dnƒõte seri√°l', it: 'Indovina la serie', type: 'buzzer', visual: 'üêâüëë‚öîÔ∏è', answer: 'Game of Thrones', image: 'https://lh3.googleusercontent.com/d/1pHuQ12SYbauup20MWXyTcqH6jF8cRw_2' },
                5: { cz: 'Uh√°dnƒõte superhrdinu', it: 'Indovina il supereroe', type: 'buzzer', visual: 'ü¶áü¶∏‚Äç‚ôÇÔ∏è', answer: 'Batman', image: 'https://lh3.googleusercontent.com/d/1TkawDFNTGv9dcGnV79btWmJnaR-0I2CG' },
                6: { cz: 'Kter√Ω film dr≈æ√≠ rekord jako nejdra≈æ≈°√≠ film v historii (rozpoƒçet p≈ôes 400 milion≈Ø dolar≈Ø)?', it: 'Quale film detiene il record come film pi√π costoso della storia (budget oltre 400 milioni di dollari)?', answers: ['Star Wars: The Force Awakens', 'Avatar', 'Avengers: Endgame', 'Pirates of the Caribbean'], correct: 0 }
            },
            6: { // Nature
                1: { cz: 'Jak√© je nejvƒõt≈°√≠ zv√≠≈ôe na svƒõtƒõ?', it: 'Qual √® l\'animale pi√π grande del mondo?', answers: ['Slon / Elefante', '≈Ωirafa / Giraffa', 'Modr√° velryba / Balenottera azzurra', 'Nosoro≈æec / Rinoceronte'], correct: 2 },
                2: { cz: 'Tich√Ω tkadlec vis√≠c√≠ mezi vƒõtvemi. M√° osm konƒçetin a mistrovsk√© d√≠lo z hedv√°b√≠. O kom je ≈ôeƒç?', it: 'Silenzioso tessitore appeso tra i rami. Ha otto arti e un capolavoro di seta. Di chi si parla?', answers: ['Mravenec / Formica', 'Pavouk / Ragno', 'Stono≈æka / Millepiedi', 'Brouk / Scarafaggio'], correct: 1, hints: [{type:'text',content:'üí° Lov√≠ hmyz'},{type:'image',content:'https://lh3.googleusercontent.com/d/1fu6i8wBraTZj3JeC4BbDfk1H5qpoPs0L'}] },
                3: { cz: '≈Ωije tam, kde jin√≠ zmrznou. Nepot≈ôebuje k≈ô√≠dla k letu, proto≈æe ve vodƒõ je rychlej≈°√≠ ne≈æ vƒõt≈°ina ryb. Kdo je tento obyvatel ledov√©ho kr√°lovstv√≠?', it: 'Vive dove gli altri congelano. Non ha bisogno di ali per volare, perch√© in acqua √® pi√π veloce della maggior parte dei pesci. Chi √® questo abitante del regno ghiacciato?', answers: ['Mro≈æ / Tricheco', 'Tuƒç≈à√°k / Pinguino', 'Ledn√≠ medvƒõd / Orso polare', 'Pol√°rn√≠ li≈°ka / Volpe artica'], correct: 1, hints: [{type:'text',content:'üí° ≈Ωije v nejchladnƒõj≈°√≠m m√≠stƒõ na Zemi'},{type:'image',content:'https://lh3.googleusercontent.com/d/1_IgBBs54MXpn6m2r44gHYKev0NYZ2CtG'}] },
                4: { cz: 'Vysok√Ω tvor ti≈°e kr√°ƒç√≠ mezi stromy. Jeho krk se tyƒç√≠ nad krajinou, ale nikdo si nen√≠ jist√Ω, kdo to vlastnƒõ je. Kter√© zv√≠≈ôe to m≈Ø≈æe b√Ωt?', it: 'Una creatura alta cammina silenziosamente tra gli alberi. Il suo collo si erge sopra il paesaggio, ma nessuno √® sicuro di chi sia veramente. Quale animale potrebbe essere?', answers: ['Brontosaurus', '≈Ωirafa / Giraffa', 'Velbloud / Cammello', 'P≈°tros / Struzzo'], correct: 1, hints: [{type:'text',content:'üí° Je to nejvy≈°≈°√≠ zv√≠≈ôe na svƒõtƒõ'},{type:'image',content:'https://lh3.googleusercontent.com/d/1AZ-ysk-Dz7PpOkEAt-Mou0-Cc7Ego9uW'}] },
                5: { cz: 'Tyto obrovsk√© stromy mohou ≈æ√≠t v√≠ce ne≈æ 3000 let a dor≈Øst v√Ω≈°ky p≈ôes 100 metr≈Ø. Rostou v Kalifornii a pat≈ô√≠ k nejstar≈°√≠m organism≈Øm na planetƒõ. Jak se jmenuj√≠?', it: 'Questi alberi giganti possono vivere pi√π di 3000 anni e raggiungere altezze superiori a 100 metri. Crescono in California e sono tra gli organismi pi√π antichi del pianeta. Come si chiamano?', answers: ['Dub / Quercia', 'Borovice / Pino', 'Sekvoje / Sequoia', 'B≈ô√≠za / Betulla'], correct: 2, hints: [{type:'text',content:'üí° Jejich k≈Øra je ƒçervenohnƒõd√°'},{type:'image',content:'https://lh3.googleusercontent.com/d/1Wgenr4rMhSptU1zGyXi0XJiqBoGhj86y'}] },
                6: { cz: 'Kter√© zv√≠≈ôe m√° nejsilnƒõj≈°√≠ kousnut√≠ na svƒõtƒõ mƒõ≈ôen√© v newtonech?', it: 'Quale animale ha il morso pi√π forte al mondo misurato in newton?', answers: ['Krokod√Ωl mo≈ôsk√Ω', 'B√≠l√Ω ≈æralok', 'Hroch', 'Jagu√°r'], correct: 0 }
            },
            7: { // History
                1: { cz: 'Ve kter√©m roce skonƒçila 2. svƒõtov√° v√°lka?', it: 'In che anno √® finita la Seconda Guerra Mondiale?', answers: ['1943', '1944', '1945', '1946'], correct: 2 },
                2: { cz: 'Betonov√° bari√©ra, kter√° rozdƒõlila mƒõsto a svƒõt na dvƒõ poloviny, padla jedn√© listopadov√© noci za j√°sotu dav≈Ø. V kter√©m roce se zaƒçaly drolit jej√≠ zdi?', it: 'Una barriera di cemento che divise la citt√† e il mondo in due met√†, cadde una notte di novembre tra il giubilo delle folle. In che anno iniziarono a sgretolarsi le sue mura?', answers: ['1987', '1989', '1991', '1993'], correct: 1, hints: [{type:'text',content:'üí° Stalo se to v Berl√≠nƒõ'},{type:'image',content:'https://lh3.googleusercontent.com/d/1Wydj3kJJOoj4xw_qqyh_hlIzNedfcaa9'}] },
                3: { cz: 'Tento americk√Ω astronaut prohl√°sil v roce 1969: "To je mal√Ω krok pro ƒçlovƒõka, ale obrovsk√Ω skok pro lidstvo." Kdo to byl?', it: 'Questo astronauta americano dichiar√≤ nel 1969: "Un piccolo passo per l\'uomo, un grande balzo per l\'umanit√†." Chi era?', answers: ['Louis Armstrong', 'Neil Armstrong', 'Lance Armstrong', 'John W. Armstrong'], correct: 1, hints: [{type:'text',content:'üí° Byl prvn√≠ ƒçlovƒõk na Mƒõs√≠ci'},{type:'image',content:'https://lh3.googleusercontent.com/d/1IynSoHj5FtB9gMfwfll1Hhh8EHk3oIp7'}] },
                4: { cz: 'Smlouva podepsan√° v historick√©m nizozemsk√©m mƒõstƒõ roku 1993 spojila n√°rody do nov√©ho celku. Jak se jmenuje organizace, kter√° z n√≠ vznikla?', it: 'Un trattato firmato in una storica citt√† olandese nel 1993 ha unito le nazioni in un nuovo insieme. Come si chiama l\'organizzazione nata da esso?', answers: ['NATO', 'Evropsk√° unie (EU)', 'OSN', 'Rada Evropy'], correct: 1, hints: [{type:'text',content:'üí° Smlouva se jmenuje Maastrichtsk√°'},{type:'image',content:'https://lh3.googleusercontent.com/d/1WZfoCmKnKFtWwSKwLaAqCET1EyxhJgWE'}] },
                5: { cz: 'T≈ôi lodƒõ ti≈°e pror√°≈æely mlhu Atlantiku. Na palubƒõ pos√°dka, kter√° netu≈°ila, ≈æe mƒõn√≠ dƒõjiny. V kter√©m roce se tato v√Ωprava vydala na cestu?', it: 'Tre navi silenziose attraversavano la nebbia dell\'Atlantico. A bordo un equipaggio che non sapeva di cambiare la storia. In che anno questa spedizione intraprese il viaggio?', answers: ['1492', '1500', '1520', '1534'], correct: 0, hints: [{type:'text',content:'üí° Objeven√≠ Ameriky / Scoperta dell\'America'},{type:'image',content:'https://lh3.googleusercontent.com/d/1nghpjz1PlTzGQ9xyyGqffv5UJfEuowWq'}] },
                6: { cz: 'Kter√° v√°lka trvala nejkrat≈°√≠ dobu v historii - pouh√Ωch 38 minut?', it: 'Quale guerra √® durata meno tempo nella storia - solo 38 minuti?', answers: ['Anglo-zanzibarsk√° v√°lka (1896)', 'V√°lka o fotbalov√Ω z√°pas (1969)', 'V√°lka ≈°esti dn≈Ø (1967)', 'V√°lka o prasata (1859)'], correct: 0 }
            },
            8: { // Sport
                1: { cz: 'Stoj√≠ tam s√°m. Jeden m√≠ƒç, jeden pohyb, jeden g√≥l‚Ä¶ nebo ne. Je to fotbal, h√°zen√°, nebo jin√Ω sport? Z jak√©ho m√≠sta se pr√°vƒõ chyst√° vyst≈ôelit?', it: 'Sta l√¨ da solo. Una palla, un movimento, un gol... o no. √à calcio, pallamano o un altro sport? Da quale posizione sta per tirare?', answers: ['Penalta (fotbal)', 'Samostatn√Ω n√°jezd (ledn√≠ hokej)', '7metrov√Ω hod (h√°zen√°)', 'N√°jezd (pozemn√≠ hokej)'], correct: 0, image: 'https://lh3.googleusercontent.com/d/1CLp94fpLLeVfcBFOVSnyu_-xcvytJ9mY' },
                2: { cz: 'Hraje se venku i pod st≈ôechou. Povrch se mƒõn√≠ jako roƒçn√≠ obdob√≠ ‚Äì oran≈æov√Ω, zelen√Ω, modr√Ω. Rychlost, ticho a rozhoduj√≠c√≠ √∫dery. O jak√Ω sport jde?', it: 'Si gioca all\'aperto e al coperto. La superficie cambia come le stagioni ‚Äì arancione, verde, blu. Velocit√†, silenzio e colpi decisivi. Di quale sport si tratta?', answers: ['Tenis', 'Squash', 'Padel', 'Badminton'], correct: 0, hints: [{type:'text',content:'üí° Hraje se s raketou a m√≠ƒçkem'},{type:'image',content:'https://lh3.googleusercontent.com/d/1Yq-etDcQUP18arRvlIVOCa1soFlfxFBC'}] },
                3: { cz: 'Odehr√°v√° se v pravideln√Ωch cyklech. Jednou ve vedru, podruh√© na snƒõhu. V√≠tƒõzstv√≠ tady neznamen√° jen zlato ‚Äì ale vƒõƒçnost. Jak se jmenuje tato oslava lidsk√©ho odhodl√°n√≠ a s√≠ly?', it: 'Si svolge in cicli regolari. Una volta nel caldo, un\'altra sulla neve. La vittoria qui non significa solo oro ‚Äì ma eternit√†. Come si chiama questa celebrazione della determinazione e forza umana?', answers: ['Olympijsk√© hry', 'Mistrovstv√≠ svƒõta', 'Evropsk√© hry', 'Letn√≠ olympi√°da'], correct: 0, hints: [{type:'text',content:'üí° Konaj√≠ se ka≈æd√© 4 roky'},{type:'image',content:'https://lh3.googleusercontent.com/d/1JFC1vqmP4UUcBLlV_okc-9bef1vB3SkJ'}] },
                4: { cz: 'Dva soupe≈ôi, t≈ôi kola, deset sekund m≈Ø≈æe rozhodnout v≈°e. V√≠tƒõz tu neodch√°z√≠ s m√≠ƒçem, ale s √∫derem. O jak√Ω sport se jedn√°?', it: 'Due avversari, tre round, dieci secondi possono decidere tutto. Il vincitore non se ne va con una palla, ma con un pugno. Di quale sport si tratta?', answers: ['Box', 'MMA', 'Z√°pas', 'Kickbox'], correct: 0, hints: [{type:'text',content:'üí° Pou≈æ√≠vaj√≠ se boxersk√© rukavice'},{type:'image',content:'https://lh3.googleusercontent.com/d/1rkI0AYu1ywy4AurOE1NOhuGw_oyUF_vw'}] },
                5: { cz: 'Kolo za kolem, ka≈æd√Ω krok m√° sv≈Øj rytmus. Kdy≈æ se spoj√≠ s√≠la, dech a strategie, v√≠tƒõz√≠ ten, kdo v√≠, kdy za√∫toƒçit. O jak√Ω sport jde?', it: 'Giro dopo giro, ogni passo ha il suo ritmo. Quando si uniscono forza, respiro e strategia, vince chi sa quando attaccare. Di quale sport si tratta?', answers: ['Atletika (bƒõh)', 'Rychlobruslen√≠', 'Veslov√°n√≠', 'Cyklistika na dr√°ze'], correct: 0, hints: [{type:'text',content:'üí° Bƒõ≈æ√≠ se na atletick√© dr√°ze'},{type:'image',content:'https://lh3.googleusercontent.com/d/1YTNUlOKp5j7HcWZip6VGFE8XLohay8Qo'}] },
                6: { cz: 'Kter√Ω plavec vyhr√°l nejv√≠ce zlat√Ωch olympijsk√Ωch medail√≠ v historii?', it: 'Quale nuotatore ha vinto il maggior numero di medaglie d\'oro olimpiche nella storia?', answers: ['Michael Phelps (23 zlat√Ωch)', 'Mark Spitz', 'Ryan Lochte', 'Ian Thorpe'], correct: 0 }
            }
        };

        class QuizApp {
            constructor() {
                this.view = 'select';
                this.teamId = null;
                this.gameData = null;
                this.timerInterval = null;
                this.hintInterval = null;
                this.countdownTimeout = null;
                this.gameTimerTimeout = null;
                this.lastRenderState = '';
                
                // Listen to Firebase changes
                gameRef.on('value', (snapshot) => {
                    const newData = snapshot.val();
                    if (!newData) {
                        // Initialize game if not exists
                        this.initializeGame();
                    } else {
                        this.gameData = newData;
                        this.render();
                    }
                });
            }

            initializeGame() {
                const initialData = {
                    gameState: 'welcome',
                    currentLevel: 1,
                    currentCategory: null,
                    countdown: 3,
                    timer: 60,
                    timerActive: false,
                    hintsShown: 0,
                    answers: {},
                    showCorrect: false,
                    buzzer: null,
                    teams: {
                        team1: { name: 'T√Ωm 1 / Squadra 1', score: 0, ready: false, completedCategories: [] },
                        team2: { name: 'T√Ωm 2 / Squadra 2', score: 0, ready: false, completedCategories: [] },
                        team3: { name: 'T√Ωm 3 / Squadra 3', score: 0, ready: false, completedCategories: [] }
                    }
                };
                gameRef.set(initialData);
            }

            updateGameState(updates) {
                gameRef.update(updates);
            }

            setView(view) {
                this.view = view;
                this.render();
            }

            joinTeam(teamId) {
                this.teamId = teamId;
                gameRef.child(`teams/${teamId}/ready`).set(true);
                this.render();
            }

            startCountdown() {
                // Just change state to countdown - HOST will click through manually
                this.updateGameState({ gameState: 'countdown', countdown: 3 });
            }
            
            decrementCountdown() {
                const newCount = this.gameData.countdown - 1;
                if (newCount === 0) {
                    this.updateGameState({ countdown: 0, gameState: 'playing' });
                } else {
                    this.updateGameState({ countdown: newCount });
                }
            }
            
            showRules() {
                this.updateGameState({ gameState: 'rules' });
            }
            
            acknowledgeRules() {
                this.updateGameState({ gameState: 'welcome' });
            }

            startTimer() {
                if (this.gameData.currentLevel === 1) return;
                this.updateGameState({ 
                    timerActive: true, 
                    timer: 60, 
                    hintsShown: 0 
                });
            }

            clearAllTimers() {
                if (this.timerInterval) {
                    clearInterval(this.timerInterval);
                    this.timerInterval = null;
                }
                if (this.hintInterval) {
                    clearInterval(this.hintInterval);
                    this.hintInterval = null;
                }
                if (this.countdownTimeout) {
                    clearTimeout(this.countdownTimeout);
                    this.countdownTimeout = null;
                }
                if (this.gameTimerTimeout) {
                    clearTimeout(this.gameTimerTimeout);
                    this.gameTimerTimeout = null;
                }
            }

            pressBuzzer(teamId) {
                if (!this.gameData.buzzer) {
                    this.updateGameState({ buzzer: teamId });
                }
            }

            submitAnswer(teamId, answer) {
                const key = `${teamId}-${this.gameData.currentLevel}-${this.gameData.currentCategory}`;
                const currentTimer = this.gameData.timer;
                
                // Save answer
                gameRef.child(`answers/${key}`).set(answer);
                
                // Save the time THIS team answered
                const timeKey = `${teamId}AnswerTime`;
                gameRef.child(timeKey).set(currentTimer);
                
                console.log(`${teamId} odpovƒõdƒõl za ${currentTimer}s, ukl√°d√°m do ${timeKey}`);
                
                // Small delay to let Firebase update, then check if all 3 teams answered
                setTimeout(() => {
                    const team1Key = `team1-${this.gameData.currentLevel}-${this.gameData.currentCategory}`;
                    const team2Key = `team2-${this.gameData.currentLevel}-${this.gameData.currentCategory}`;
                    const team3Key = `team3-${this.gameData.currentLevel}-${this.gameData.currentCategory}`;
                    
                    const team1Answered = this.gameData.answers?.[team1Key] !== undefined;
                    const team2Answered = this.gameData.answers?.[team2Key] !== undefined;
                    const team3Answered = this.gameData.answers?.[team3Key] !== undefined;
                    
                    if (team1Answered && team2Answered && team3Answered) {
                        // All 3 teams answered! Stop timer
                        gameRef.update({ timerActive: false });
                        console.log('V≈°echny 3 t√Ωmy odpovƒõdƒõly! ƒåasovaƒç zastaven.');
                    }
                }, 500);
            }

            awardPoints(teamId, points) {
                const currentScore = this.gameData.teams[teamId].score;
                gameRef.child(`teams/${teamId}/score`).set(currentScore + points);
                
                // Mark category as completed for buzzer questions
                const answerKey = `${teamId}-${this.gameData.currentLevel}-${this.gameData.currentCategory}`;
                gameRef.child(`answers/${answerKey}`).set('buzzer_correct');
                
                this.nextQuestion();
            }
            
            buzzerIncorrect() {
                // Mark as completed but no points
                const answerKey = `team1-${this.gameData.currentLevel}-${this.gameData.currentCategory}`;
                gameRef.child(`answers/${answerKey}`).set('buzzer_incorrect');
                this.nextQuestion();
            }
            
            evaluateKnowledgeAnswers() {
                const d = this.gameData;
                const q = QUESTIONS[d.currentCategory][d.currentLevel];
                
                const team1Key = `team1-${d.currentLevel}-${d.currentCategory}`;
                const team2Key = `team2-${d.currentLevel}-${d.currentCategory}`;
                const team3Key = `team3-${d.currentLevel}-${d.currentCategory}`;
                
                const team1Answer = d.answers?.[team1Key];
                const team2Answer = d.answers?.[team2Key];
                const team3Answer = d.answers?.[team3Key];
                
                // Check if answers are correct
                const team1Correct = team1Answer === q.correct;
                const team2Correct = team2Answer === q.correct;
                const team3Correct = team3Answer === q.correct;
                
                console.log('=== BODOV√ÅN√ç ===');
                
                // Award points to Team 1
                if (team1Correct) {
                    let points = this.calculatePoints();
                    const team1Time = d.team1AnswerTime || d.timer;
                    
                    console.log('T√Ωm 1: odpovƒõdƒõl za', team1Time, 's');
                    console.log('P≈Øvodn√≠ body:', points);
                    
                    if (d.currentLevel > 1) {
                        if (team1Time <= 20) {
                            console.log('Penalizace: -7 bod≈Ø (ƒças <= 20s)');
                            points -= 7;
                        } else if (team1Time <= 40) {
                            console.log('Penalizace: -3 body (ƒças <= 40s)');
                            points -= 3;
                        } else {
                            console.log('Pln√© body (ƒças > 40s)');
                        }
                        points = Math.max(points, 1);
                    }
                    
                    console.log('Fin√°ln√≠ body pro T√Ωm 1:', points);
                    const currentScore = d.teams.team1.score;
                    gameRef.child('teams/team1/score').set(currentScore + points);
                }
                
                // Award points to Team 2
                if (team2Correct) {
                    let points = this.calculatePoints();
                    const team2Time = d.team2AnswerTime || d.timer;
                    
                    console.log('T√Ωm 2: odpovƒõdƒõl za', team2Time, 's');
                    console.log('P≈Øvodn√≠ body:', points);
                    
                    if (d.currentLevel > 1) {
                        if (team2Time <= 20) {
                            console.log('Penalizace: -7 bod≈Ø (ƒças <= 20s)');
                            points -= 7;
                        } else if (team2Time <= 40) {
                            console.log('Penalizace: -3 body (ƒças <= 40s)');
                            points -= 3;
                        } else {
                            console.log('Pln√© body (ƒças > 40s)');
                        }
                        points = Math.max(points, 1);
                    }
                    
                    console.log('Fin√°ln√≠ body pro T√Ωm 2:', points);
                    const currentScore = d.teams.team2.score;
                    gameRef.child('teams/team2/score').set(currentScore + points);
                }
                
                // Award points to Team 3
                if (team3Correct) {
                    let points = this.calculatePoints();
                    const team3Time = d.team3AnswerTime || d.timer;
                    
                    console.log('T√Ωm 3: odpovƒõdƒõl za', team3Time, 's');
                    console.log('P≈Øvodn√≠ body:', points);
                    
                    if (d.currentLevel > 1) {
                        if (team3Time <= 20) {
                            console.log('Penalizace: -7 bod≈Ø (ƒças <= 20s)');
                            points -= 7;
                        } else if (team3Time <= 40) {
                            console.log('Penalizace: -3 body (ƒças <= 40s)');
                            points -= 3;
                        } else {
                            console.log('Pln√© body (ƒças > 40s)');
                        }
                        points = Math.max(points, 1);
                    }
                    
                    console.log('Fin√°ln√≠ body pro T√Ωm 3:', points);
                    const currentScore = d.teams.team3.score;
                    gameRef.child('teams/team3/score').set(currentScore + points);
                }
                
                console.log('================');
                
                // Clear answer times for next question
                gameRef.child('team1AnswerTime').remove();
                gameRef.child('team2AnswerTime').remove();
                gameRef.child('team3AnswerTime').remove();
                
                // Move to next question
                this.nextQuestion();
            }

            showCorrectAnswer() {
                // Just show the answer - finalAnswerTime was already saved when both teams answered
                gameRef.update({ showCorrect: true });
            }

            selectCategory(categoryId) {
                const team1Key = `team1-${this.gameData.currentLevel}-${categoryId}`;
                const team2Key = `team2-${this.gameData.currentLevel}-${categoryId}`;
                const isCompleted = this.gameData.answers && 
                                   (this.gameData.answers[team1Key] !== undefined || 
                                    this.gameData.answers[team2Key] !== undefined);
                
                if (isCompleted) return;

                this.updateGameState({
                    currentCategory: categoryId,
                    timer: 60,
                    timerActive: false,
                    hintsShown: 0,
                    showCorrect: false,
                    buzzer: null
                });
            }

            nextQuestion() {
                // Count how many categories are completed (not total answers)
                const answers = this.gameData.answers || {};
                const completedCategories = new Set();
                
                Object.keys(answers).forEach(key => {
                    // Extract category ID from key like "team1-1-3"
                    const parts = key.split('-');
                    const level = parseInt(parts[1]);
                    const categoryId = parseInt(parts[2]);
                    
                    if (level === this.gameData.currentLevel) {
                        completedCategories.add(categoryId); // category ID
                    }
                });
                
                console.log('Completed categories:', completedCategories.size, 'out of 7');
                
                if (completedCategories.size >= 8) {
                    this.updateGameState({ gameState: 'levelEnd' });
                } else {
                    this.updateGameState({
                        currentCategory: null,
                        timer: 60,
                        timerActive: false,
                        hintsShown: 0,
                        showCorrect: false,
                        buzzer: null
                    });
                }
            }

            nextLevel() {
                if (this.gameData.currentLevel >= 6) {
                    this.updateGameState({ gameState: 'finished' });
                } else {
                    this.updateGameState({
                        currentLevel: this.gameData.currentLevel + 1,
                        currentCategory: null,
                        gameState: 'playing',
                        timer: 60,
                        timerActive: false,
                        hintsShown: 0,
                        showCorrect: false,
                        buzzer: null
                    });
                }
            }

            calculatePoints() {
                if (!this.gameData) return 0;
                const level = this.gameData.currentLevel;
                const cat = CATEGORIES.find(c => c.id === this.gameData.currentCategory);
                if (!cat) return 0;
                // Level 6 gets 2.5x bonus points
                const multiplier = level === 6 ? 2.5 : 1;
                return cat.points * level * multiplier;
            }

            resetAll() {
                if (confirm('Opravdu chcete resetovat celou hru? / Vuoi davvero resettare l\'intero gioco?')) {
                    gameRef.remove().then(() => {
                        this.view = 'select';
                        this.teamId = null;
                        this.initializeGame();
                    });
                }
            }

            render() {
                const root = document.getElementById('root');
                if (!root || !this.gameData) return;
                
                root.innerHTML = '';
                
                if (this.view === 'select') {
                    root.innerHTML = this.renderViewSelect();
                } else if (this.view === 'host') {
                    root.innerHTML = this.renderHost();
                    // Start game timer if active (for levels 2-5)
                    this.handleGameTimer();
                } else if (this.view === 'team') {
                    root.innerHTML = this.renderTeam();
                }
            }
            
            handleGameTimer() {
                const d = this.gameData;
                if (!d || this.view !== 'host') return;
                
                // Only handle game timer (60s timer for levels 2-5)
                if (d.currentLevel > 1 && d.timerActive && d.timer > 0 && d.gameState === 'playing' && d.currentCategory) {
                    if (!this.gameTimerTimeout) {
                        this.gameTimerTimeout = setTimeout(() => {
                            this.gameTimerTimeout = null;
                            const newTimer = this.gameData.timer - 1;
                            
                            // Check for hints
                            const elapsed = 60 - newTimer;
                            const q = QUESTIONS[d.currentCategory]?.[d.currentLevel];
                            let updates = { timer: newTimer };
                            
                            if (q?.hints) {
                                if (elapsed === 20 && this.gameData.hintsShown === 0) {
                                    updates.hintsShown = 1;
                                } else if (elapsed === 40 && this.gameData.hintsShown === 1) {
                                    updates.hintsShown = 2;
                                }
                            }
                            
                            if (newTimer === 0) {
                                updates.timerActive = false;
                            }
                            
                            this.updateGameState(updates);
                        }, 1000);
                    }
                } else if (this.gameTimerTimeout) {
                    clearTimeout(this.gameTimerTimeout);
                    this.gameTimerTimeout = null;
                }
            }

            renderViewSelect() {
                return `<div class="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-8">
                    <div class="max-w-2xl w-full"><div class="text-center mb-12"><div class="text-8xl mb-6">üåç</div>
                    <h1 class="text-7xl font-bold text-white mb-4 font-oswald" style="text-shadow: 0 0 20px rgba(255,255,255,0.3)">WE LOVE THE WORLD</h1></div>
                    <div class="grid gap-6">
                    <button onclick="app.setView('host')" class="bg-gradient-to-r from-yellow-400 to-orange-500 text-gray-900 text-2xl font-bold py-8 px-8 rounded-2xl hover:scale-105 transition-all shadow-2xl font-oswald">üèÜ HOST</button>
                    <button onclick="app.setView('team')" class="bg-gradient-to-r from-green-400 to-blue-500 text-white text-2xl font-bold py-8 px-8 rounded-2xl hover:scale-105 transition-all shadow-2xl font-oswald">üë• T√ùM</button>
                    <button onclick="app.resetAll()" class="bg-gradient-to-r from-red-500 to-pink-600 text-white text-xl font-bold py-4 px-8 rounded-2xl hover:scale-105 transition-all shadow-2xl font-oswald">üîÑ RESET CEL√â HRY</button>
                    </div>
                    <div class="text-center mt-8 text-gray-400 text-sm opacity-70">¬© 2025 Created by TOOM & Claude.ai</div>
                    </div></div>`;
            }

            renderHost() {
                const d = this.gameData;
                if (d.gameState === 'rules') {
                    return `<div class="min-h-screen bg-gradient-to-br from-blue-900 to-purple-900 text-white p-8"><div class="max-w-4xl mx-auto">
                    <div class="text-center mb-8"><div class="text-8xl mb-6">üìú</div>
                    <h1 class="text-6xl font-bold mb-8 font-oswald">PRAVIDLA HRY / REGOLE DEL GIOCO</h1></div>
                    <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-8 mb-8 text-xl space-y-6">
                    <div class="border-b border-white/20 pb-4">
                    <h2 class="text-3xl font-bold mb-4 text-yellow-400">üéØ C√çL HRY / OBIETTIVO</h2>
                    <p class="mb-2"><strong>CZ:</strong> Odpov√≠dejte na ot√°zky o svƒõtƒõ a z√≠sk√°vejte body. V√≠tƒõz√≠ t√Ωm s nejv√≠ce body po 5 levelech!</p>
                    <p><strong>IT:</strong> Rispondete alle domande sul mondo e guadagnate punti. Vince la squadra con pi√π punti dopo 5 livelli!</p>
                    </div>
                    <div class="border-b border-white/20 pb-4">
                    <h2 class="text-3xl font-bold mb-4 text-yellow-400">üìä LEVELY / LIVELLI</h2>
                    <p class="mb-2"><strong>CZ:</strong> Hra m√° 6 level≈Ø. Levely 1-5 maj√≠ 8 kategori√≠ ka≈æd√Ω. Level 6 je BONUS CHALLENGE s 2.5√ó body a bez n√°povƒõd!</p>
                    <p><strong>IT:</strong> Il gioco ha 6 livelli. I livelli 1-5 hanno 8 categorie ciascuno. Il livello 6 √® BONUS CHALLENGE con punti 2.5√ó e senza suggerimenti!</p>
                    </div>
                    <div class="border-b border-white/20 pb-4">
                    <h2 class="text-3xl font-bold mb-4 text-yellow-400">üéÆ DVA TYPY OT√ÅZEK / DUE TIPI DI DOMANDE</h2>
                    <p class="mb-3"><strong>1. BUZZER (Level 1 - Hudba & Filmy):</strong></p>
                    <p class="mb-2"><strong>CZ:</strong> Prvn√≠ t√Ωm, kter√Ω zm√°ƒçkne buzzer, odpov√≠d√°. Spr√°vn√° odpovƒõƒè = body. ≈†patn√° = soupe≈ô m≈Ø≈æe odpovƒõdƒõt.</p>
                    <p class="mb-3"><strong>IT:</strong> La prima squadra che preme il buzzer risponde. Risposta corretta = punti. Sbagliata = l'avversario pu√≤ rispondere.</p>
                    <p class="mb-3"><strong>2. KNOWLEDGE (Level 2-5 - ostatn√≠ kategorie):</strong></p>
                    <p class="mb-2"><strong>CZ:</strong> Oba t√Ωmy odpov√≠daj√≠ samostatnƒõ na tabletech. M√°te 60 sekund. Po 20 a 40 sekund√°ch se objev√≠ n√°povƒõda. Host vyhodnot√≠ odpovƒõdi.</p>
                    <p><strong>IT:</strong> Entrambe le squadre rispondono separatamente sui tablet. Avete 60 secondi. Dopo 20 e 40 secondi appare un suggerimento. L'host valuta le risposte.</p>
                    </div>
                    <div class="border-b border-white/20 pb-4">
                    <h2 class="text-3xl font-bold mb-4 text-yellow-400">üíé BODOV√ÅN√ç / PUNTEGGIO</h2>
                    <p class="mb-2"><strong>CZ:</strong> Body rostou s levelem: Level 1 = 10-15 bod≈Ø, Level 2 = 20-30 bod≈Ø, atd. Hudba a Filmy d√°vaj√≠ v√≠c bod≈Ø!</p>
                    <p><strong>IT:</strong> I punti crescono con il livello: Livello 1 = 10-15 punti, Livello 2 = 20-30 punti, ecc. Musica e Film danno pi√π punti!</p>
                    </div>
                    <div>
                    <h2 class="text-3xl font-bold mb-4 text-yellow-400">üèÜ V√çTƒöZ / VINCITORE</h2>
                    <p class="mb-2"><strong>CZ:</strong> Po 5 levelech vyhr√°v√° t√Ωm s nejv√≠ce body!</p>
                    <p><strong>IT:</strong> Dopo 5 livelli vince la squadra con pi√π punti!</p>
                    </div>
                    </div>
                    <div class="text-center">
                    <button onclick="app.acknowledgeRules()" class="bg-gradient-to-r from-green-400 to-blue-500 text-white text-4xl font-bold py-8 px-16 rounded-2xl font-oswald hover:scale-105 transition-all">
                    ‚úì ROZUM√çM / CAPISCO
                    </button>
                    </div>
                    </div></div>`;
                }
                if (d.gameState === 'welcome') {
                    return `<div class="min-h-screen bg-gradient-to-br from-purple-900 to-indigo-900 text-white p-12"><div class="max-w-6xl mx-auto text-center">
                    <div class="text-9xl mb-6 animate-bounce">üåç</div><h1 class="text-8xl font-bold mb-12 font-oswald" style="background: linear-gradient(to right, #fbbf24, #f97316); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">WE LOVE THE WORLD</h1>
                    <div class="grid grid-cols-3 gap-6 mb-8">
                    <div class="p-6 rounded-xl ${d.teams.team1.ready ? 'bg-green-500' : 'bg-gray-700'}"><p class="text-2xl font-bold">${d.teams.team1.name}</p><p class="text-xl">${d.teams.team1.ready ? '‚úì Ready' : '‚è≥ Waiting'}</p></div>
                    <div class="p-6 rounded-xl ${d.teams.team2.ready ? 'bg-green-500' : 'bg-gray-700'}"><p class="text-2xl font-bold">${d.teams.team2.name}</p><p class="text-xl">${d.teams.team2.ready ? '‚úì Ready' : '‚è≥ Waiting'}</p></div>
                    <div class="p-6 rounded-xl ${d.teams.team3.ready ? 'bg-green-500' : 'bg-gray-700'}"><p class="text-2xl font-bold">${d.teams.team3.name}</p><p class="text-xl">${d.teams.team3.ready ? '‚úì Ready' : '‚è≥ Waiting'}</p></div>
                    </div>
                    <div class="flex gap-6 justify-center mb-8">
                    <button onclick="app.showRules()" class="bg-gradient-to-r from-blue-400 to-purple-500 text-white text-3xl font-bold py-6 px-12 rounded-2xl font-oswald hover:scale-105 transition-all">
                    üìú PRAVIDLA / REGOLE
                    </button>
                    ${d.teams.team1.ready && d.teams.team2.ready && d.teams.team3.ready ? '<button onclick="app.startCountdown()" class="bg-gradient-to-r from-green-400 to-blue-500 text-white text-3xl font-bold py-6 px-12 rounded-2xl font-oswald animate-pulse">üöÄ START</button>' : ''}
                    </div>
                    <div class="text-center mt-12 text-gray-400 text-sm opacity-70">¬© 2025 Created by TOOM & Claude.ai</div>
                    </div></div>`;
                }
                if (d.gameState === 'countdown') {
                    const btnHtml = d.countdown > 0 ? '<button onclick="app.decrementCountdown()" class="bg-white text-gray-900 text-4xl font-bold py-8 px-16 rounded-2xl font-oswald hover:scale-105 transition-all">üëâ DAL≈†√ç / AVANTI</button>' : '';
                    return `<div class="min-h-screen bg-gradient-to-br from-red-900 to-yellow-900 flex flex-col items-center justify-center">
                    <h1 class="text-[20rem] font-bold text-white font-oswald mb-12">${d.countdown > 0 ? d.countdown : 'üéâ'}</h1>
                    ${btnHtml}
                    </div>`;
                }
                if (d.gameState === 'playing') {
                    if (!d.currentCategory) {
                        return `<div class="min-h-screen bg-gradient-to-br from-indigo-900 to-purple-900 text-white p-8"><div class="max-w-7xl mx-auto">
                        <div class="flex justify-between items-center mb-8">
                        <div class="text-3xl font-bold">LEVEL ${d.currentLevel}/6${d.currentLevel === 6 ? ' üéØ BONUS' : ''}</div>
                        <div class="grid grid-cols-3 gap-6">
                        <div class="text-xl font-bold">${d.teams.team1.name}: ${d.teams.team1.score}</div>
                        <div class="text-xl font-bold">${d.teams.team2.name}: ${d.teams.team2.score}</div>
                        <div class="text-xl font-bold">${d.teams.team3.name}: ${d.teams.team3.score}</div>
                        </div>
                        </div>
                        <h2 class="text-5xl font-bold text-center mb-12 font-oswald">VYBERTE KATEGORII / SCEGLI CATEGORIA</h2>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                        ${CATEGORIES.map(cat => {
                            const team1Key = `team1-${d.currentLevel}-${cat.id}`;
                            const team2Key = `team2-${d.currentLevel}-${cat.id}`;
                            const isCompleted = d.answers && (d.answers[team1Key] !== undefined || d.answers[team2Key] !== undefined);
                            return `<button onclick="app.selectCategory(${cat.id})" ${isCompleted ? 'disabled' : ''} class="relative ${isCompleted ? 'bg-gray-600 opacity-50 cursor-not-allowed' : 'bg-gradient-to-br from-blue-500 to-purple-600 hover:scale-105'} text-2xl font-bold py-12 px-6 rounded-2xl transition-all font-oswald">
                            <div class="text-6xl mb-3">${cat.icon}</div>
                            <div>${cat.name}</div>
                            <div class="text-yellow-400 mt-2">üíé ${cat.points * d.currentLevel}</div>
                            ${isCompleted ? '<div class="absolute top-4 right-4 text-4xl">‚úì</div>' : ''}
                            </button>`;
                        }).join('')}
                        </div>
                        </div></div>`;
                    }
                    
                    const cat = CATEGORIES.find(c => c.id === d.currentCategory);
                    const q = QUESTIONS[d.currentCategory][d.currentLevel];
                    const isLevel1 = d.currentLevel === 1;
                    
                    if (cat.type === 'buzzer') {
                        return `<div class="min-h-screen bg-gradient-to-br from-pink-900 to-purple-900 text-white p-12"><div class="max-w-6xl mx-auto text-center">
                        <div class="flex justify-between items-center mb-8">
                        <div class="text-2xl font-bold bg-white/20 px-6 py-3 rounded-full">LEVEL ${d.currentLevel}/6${d.currentLevel === 6 ? ' üéØ' : ''}</div>
                        <div class="text-4xl font-bold bg-yellow-400 text-gray-900 px-8 py-3 rounded-full">${cat.icon} ${cat.name}</div>
                        <div class="text-2xl font-bold bg-green-500 px-6 py-3 rounded-full">üíé ${this.calculatePoints()}</div>
                        </div>
                        <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-12 mb-8">
                        <div class="text-3xl mb-8"><p class="mb-4">${q.cz}</p><p class="text-blue-200">${q.it}</p></div>
                        ${q.image ? `<img src="${q.image}" style="max-width: 600px; max-height: 600px;" class="mx-auto rounded-lg mb-8">` : `<div class="text-9xl mb-8">${q.visual}</div>`}
                        ${!d.buzzer ? '<p class="text-2xl text-yellow-300 animate-pulse font-oswald mb-8">ƒåek√°me na buzzer... / Aspettiamo il buzzer...</p>' : `<div class="text-3xl font-bold mb-8">üîî ${d.teams[d.buzzer].name}</div>`}
                        </div>
                        ${!d.buzzer ? `<button onclick="app.buzzerIncorrect()" class="bg-gray-600 text-white text-2xl font-bold py-4 px-12 rounded-xl hover:scale-105 transition-all">‚û°Ô∏è BEZ ODPOVƒöDI / NESSUNA RISPOSTA</button>` : ''}
                        ${d.buzzer ? `<div class="flex gap-6 justify-center">
                        <button onclick="app.awardPoints('${d.buzzer}',${cat.points * d.currentLevel})" class="bg-green-500 text-2xl font-bold py-4 px-12 rounded-xl hover:scale-105 transition-all">‚úì Spr√°vnƒõ / Corretto</button>
                        <button onclick="app.buzzerIncorrect()" class="bg-red-500 text-2xl font-bold py-4 px-12 rounded-xl hover:scale-105 transition-all">‚úó ≈†patnƒõ / Sbagliato</button>
                        </div>` : ''}
                        </div></div></div>`;
                    } else {
                        const team1Answered = d.answers && d.answers[`team1-${d.currentLevel}-${d.currentCategory}`] !== undefined;
                        const team2Answered = d.answers && d.answers[`team2-${d.currentLevel}-${d.currentCategory}`] !== undefined;
                        const team3Answered = d.answers && d.answers[`team3-${d.currentLevel}-${d.currentCategory}`] !== undefined;
                        const allAnswered = team1Answered && team2Answered && team3Answered;
                        const showCorrect = d.showCorrect || false;
                        
                        let timerColor = 'text-green-400';
                        if (d.timer <= 20) timerColor = 'text-red-400 timer-pulse';
                        else if (d.timer <= 40) timerColor = 'text-yellow-400';
                        
                        return `<div class="min-h-screen bg-gradient-to-br from-indigo-900 to-pink-900 text-white p-8"><div class="max-w-7xl mx-auto">
                        <div class="flex justify-between items-center mb-8">
                        <div class="text-2xl font-bold bg-white/20 px-6 py-3 rounded-full">LEVEL ${d.currentLevel}/6${d.currentLevel === 6 ? ' üéØ' : ''}</div>
                        <div class="text-4xl font-bold bg-yellow-400 text-gray-900 px-8 py-3 rounded-full">${cat.icon} ${cat.name}</div>
                        <div class="text-2xl font-bold bg-green-500 px-6 py-3 rounded-full">üíé ${this.calculatePoints()}</div>
                        </div>
                        
                        ${!isLevel1 && d.timerActive ? `<div class="text-center mb-8"><div class="text-6xl font-bold ${timerColor} font-oswald">${d.timer}s</div></div>` : ''}
                        
                        <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-12 mb-8">
                        <div class="text-3xl text-center mb-8"><p class="mb-4">${q.cz}</p><p class="text-blue-200">${q.it}</p></div>
                        
                        ${!isLevel1 && q.hints && d.hintsShown > 0 ? `<div class="mb-8 text-center text-2xl text-yellow-300">${q.hints[d.hintsShown-1].type === 'image' ? `<img src="${q.hints[d.hintsShown-1].content}" class="mx-auto rounded-lg" style="max-width: 300px; max-height: 300px;" alt="N√°povƒõda">` : q.hints[d.hintsShown-1].content}</div>` : ''}
                        
                        <div class="grid grid-cols-2 gap-6 mb-8">
                        ${q.answers.map((a,i)=>`<div class="text-2xl font-bold py-8 px-6 rounded-xl text-center transition-all ${showCorrect && i===q.correct ? 'bg-green-500 ring-4 ring-green-300 scale-105' : 'bg-white/20'}">
                        <span class="text-yellow-400 text-3xl mr-3">${String.fromCharCode(65+i)}</span>${a}</div>`).join('')}
                        </div>
                        
                        <div class="grid grid-cols-3 gap-6 mb-8">
                        <div class="p-6 rounded-xl ${team1Answered ? 'bg-green-500' : 'bg-red-500/50'}">
                        <p class="text-2xl font-bold text-center">${team1Answered ? '‚úì' : 'üî¥'} ${d.teams.team1.name}</p>
                        <p class="text-xl text-center">${team1Answered ? 'Odpovƒõdƒõl / Ha risposto' : 'ƒåek√°me / Aspettiamo'}</p>
                        </div>
                        <div class="p-6 rounded-xl ${team2Answered ? 'bg-green-500' : 'bg-red-500/50'}">
                        <p class="text-2xl font-bold text-center">${team2Answered ? '‚úì' : 'üî¥'} ${d.teams.team2.name}</p>
                        <p class="text-xl text-center">${team2Answered ? 'Odpovƒõdƒõl / Ha risposto' : 'ƒåek√°me / Aspettiamo'}</p>
                        </div>
                        <div class="p-6 rounded-xl ${team3Answered ? 'bg-green-500' : 'bg-red-500/50'}">
                        <p class="text-2xl font-bold text-center">${team3Answered ? '‚úì' : 'üî¥'} ${d.teams.team3.name}</p>
                        <p class="text-xl text-center">${team3Answered ? 'Odpovƒõdƒõl / Ha risposto' : 'ƒåek√°me / Aspettiamo'}</p>
                        </div>
                        </div>
                        </div>
                        
                        <div class="text-center">
                        ${!showCorrect && allAnswered ? `
                        <button onclick="app.showCorrectAnswer()" class="bg-gradient-to-r from-yellow-400 to-orange-500 text-gray-900 text-3xl font-bold py-6 px-16 rounded-2xl hover:scale-105 transition-all shadow-2xl font-oswald mb-4">
                        üìã ZOBRAZIT SPR√ÅVNOU ODPOVƒöƒé
                        </button>` : ''}
                        ${showCorrect ? `
                        <button onclick="app.evaluateKnowledgeAnswers()" class="bg-gradient-to-r from-green-400 to-blue-500 text-white text-3xl font-bold py-6 px-16 rounded-2xl hover:scale-105 transition-all font-oswald">
                        ‚û°Ô∏è DAL≈†√ç OT√ÅZKA
                        </button>` : ''}
                        ${!isLevel1 && !allAnswered && !d.timerActive ? `
                        <button onclick="app.startTimer()" class="bg-gradient-to-r from-blue-400 to-purple-500 text-3xl font-bold py-6 px-16 rounded-2xl font-oswald hover:scale-105 transition-all">
                        ‚è±Ô∏è SPUSTIT ƒåASOVAƒå
                        </button>` : ''}
                        </div>
                        </div></div>`;
                    }
                }
                
                if (d.gameState === 'levelEnd') {
                    return `<div class="min-h-screen bg-gradient-to-br from-green-900 to-blue-900 text-white flex items-center justify-center p-12">
                    <div class="max-w-5xl w-full text-center">
                    <div class="text-9xl mb-8">üéâ</div>
                    <h1 class="text-6xl font-bold mb-12 font-oswald">LEVEL ${d.currentLevel} DOKONƒåEN!</h1>
                    <div class="grid grid-cols-3 gap-6 mb-12">
                    <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-6">
                    <p class="text-2xl font-bold mb-4">${d.teams.team1.name}</p>
                    <p class="text-6xl font-bold text-yellow-400">${d.teams.team1.score}</p>
                    </div>
                    <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-6">
                    <p class="text-2xl font-bold mb-4">${d.teams.team2.name}</p>
                    <p class="text-6xl font-bold text-yellow-400">${d.teams.team2.score}</p>
                    </div>
                    <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-6">
                    <p class="text-2xl font-bold mb-4">${d.teams.team3.name}</p>
                    <p class="text-6xl font-bold text-yellow-400">${d.teams.team3.score}</p>
                    </div>
                    </div>
                    <button onclick="app.nextLevel()" class="bg-gradient-to-r from-yellow-400 to-orange-500 text-gray-900 text-4xl font-bold py-8 px-16 rounded-2xl font-oswald hover:scale-105 transition-all">
                    ${d.currentLevel < 5 ? '‚û°Ô∏è DAL≈†√ç LEVEL' : d.currentLevel === 5 ? 'üéØ BONUS LEVEL 6' : 'üèÜ V√ùSLEDKY'}
                    </button>
                    </div></div>`;
                }
                
                if (d.gameState === 'finished') {
                    // Sort teams by score
                    const teams = [
                        { id: 'team1', ...d.teams.team1 },
                        { id: 'team2', ...d.teams.team2 },
                        { id: 'team3', ...d.teams.team3 }
                    ].sort((a, b) => b.score - a.score);
                    
                    const first = teams[0];
                    const second = teams[1];
                    const third = teams[2];
                    
                    return `<div class="min-h-screen bg-gradient-to-br from-yellow-900 to-orange-900 text-white flex items-center justify-center p-12">
                    <div class="max-w-6xl w-full text-center">
                    <div class="text-9xl mb-8">üèÜ</div>
                    <h1 class="text-7xl font-bold mb-12 font-oswald">HRA SKONƒåILA!</h1>
                    <h2 class="text-5xl font-bold mb-12 text-yellow-300">üéâ ${first.name} VYHR√ÅV√Å! üéâ</h2>
                    
                    <div class="flex items-end justify-center gap-6 mb-12">
                        <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-6 w-64" style="height: 280px;">
                            <div class="text-6xl mb-4">ü•à</div>
                            <p class="text-2xl font-bold mb-3">${second.name}</p>
                            <p class="text-6xl font-bold text-gray-300">${second.score}</p>
                            <p class="text-xl text-gray-400 mt-2">2. M√çSTO</p>
                        </div>
                        <div class="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-3xl p-8 w-72" style="height: 360px;">
                            <div class="text-8xl mb-4">ü•á</div>
                            <p class="text-3xl font-bold mb-4 text-gray-900">${first.name}</p>
                            <p class="text-8xl font-bold text-gray-900">${first.score}</p>
                            <p class="text-2xl text-gray-800 mt-3">1. M√çSTO</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-6 w-64" style="height: 220px;">
                            <div class="text-5xl mb-4">ü•â</div>
                            <p class="text-2xl font-bold mb-3">${third.name}</p>
                            <p class="text-5xl font-bold text-amber-600">${third.score}</p>
                            <p class="text-xl text-gray-400 mt-2">3. M√çSTO</p>
                        </div>
                    </div>
                    <p class="text-2xl text-gray-300 mt-8">Gratulujeme v≈°em! üéä</p>
                    </div></div>`;
                }
            }

            renderTeam() {
                const d = this.gameData;
                
                if (!this.teamId) {
                    const team1Taken = d.teams.team1.ready;
                    const team2Taken = d.teams.team2.ready;
                    
                    return `<div class="min-h-screen bg-gradient-to-br from-purple-900 to-indigo-900 text-white p-8"><div class="max-w-2xl mx-auto">
                    <div class="text-center mb-12"><div class="text-8xl mb-6">üåç</div><h1 class="text-5xl font-bold mb-4 font-oswald">VYBERTE T√ùM</h1></div>
                    <div class="grid gap-6">
                    <button onclick="app.joinTeam('team1')" ${team1Taken ? 'disabled' : ''} class="relative ${team1Taken ? 'bg-gray-600 opacity-50 cursor-not-allowed' : 'bg-gradient-to-r from-blue-500 to-purple-600 hover:scale-105'} text-3xl font-bold py-12 px-8 rounded-2xl font-oswald transition-all">
                    üîµ ${d.teams.team1.name}
                    ${team1Taken ? '<div class="text-xl mt-2">‚ùå Obsazeno / Occupato</div>' : ''}
                    </button>
                    <button onclick="app.joinTeam('team2')" ${team2Taken ? 'disabled' : ''} class="relative ${team2Taken ? 'bg-gray-600 opacity-50 cursor-not-allowed' : 'bg-gradient-to-r from-green-500 to-teal-600 hover:scale-105'} text-3xl font-bold py-12 px-8 rounded-2xl font-oswald transition-all">
                    üü¢ ${d.teams.team2.name}
                    ${team2Taken ? '<div class="text-xl mt-2">‚ùå Obsazeno / Occupato</div>' : ''}
                    </button>
                    <button onclick="app.joinTeam('team3')" ${d.teams.team3?.ready ? 'disabled' : ''} class="relative ${d.teams.team3?.ready ? 'bg-gray-600 opacity-50 cursor-not-allowed' : 'bg-gradient-to-r from-orange-500 to-red-600 hover:scale-105'} text-3xl font-bold py-12 px-8 rounded-2xl font-oswald transition-all">
                    üü† ${d.teams.team3.name}
                    ${d.teams.team3?.ready ? '<div class="text-xl mt-2">‚ùå Obsazeno / Occupato</div>' : ''}
                    </button>
                    </div></div></div>`;
                }
                
                if (d.gameState === 'rules') {
                    return `<div class="min-h-screen bg-gradient-to-br from-blue-900 to-purple-900 text-white p-8 overflow-y-auto">
                    <div class="max-w-3xl mx-auto">
                    <div class="text-center mb-6"><div class="text-6xl mb-4">üìú</div>
                    <h1 class="text-4xl font-bold mb-6 font-oswald">PRAVIDLA / REGOLE</h1></div>
                    <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 space-y-4 text-lg">
                    <div class="border-b border-white/20 pb-3">
                    <h2 class="text-2xl font-bold mb-2 text-yellow-400">üéØ C√çL</h2>
                    <p class="text-sm"><strong>CZ:</strong> Z√≠sk√°vejte body odpov√≠d√°n√≠m na ot√°zky. V√≠tƒõz√≠ t√Ωm s nejv√≠ce body!</p>
                    <p class="text-sm"><strong>IT:</strong> Guadagnate punti rispondendo. Vince chi ha pi√π punti!</p>
                    </div>
                    <div class="border-b border-white/20 pb-3">
                    <h2 class="text-2xl font-bold mb-2 text-yellow-400">üéÆ DVA TYPY</h2>
                    <p class="text-sm mb-2"><strong>BUZZER (Level 1):</strong> Prvn√≠ kdo zm√°ƒçkne / Chi preme per primo</p>
                    <p class="text-sm"><strong>KNOWLEDGE (Level 2-5):</strong> Oba t√Ωmy odpov√≠daj√≠, 60s, n√°povƒõdy / Entrambi rispondono, 60s, suggerimenti</p>
                    </div>
                    <div class="border-b border-white/20 pb-3">
                    <h2 class="text-2xl font-bold mb-2 text-yellow-400">üíé BODY</h2>
                    <p class="text-sm">Body rostou s levelem! / I punti crescono col livello!</p>
                    </div>
                    <div>
                    <h2 class="text-2xl font-bold mb-2 text-yellow-400">üèÜ V√ùHRA</h2>
                    <p class="text-sm">5 level≈Ø, nejv√≠c bod≈Ø vyhr√°v√°! / 5 livelli, pi√π punti vince!</p>
                    </div>
                    </div>
                    <div class="text-center mt-6 text-gray-300 text-sm">ƒåek√°me na HOST... / Aspettiamo l'HOST...</div>
                    </div></div>`;
                }
                
                if (d.gameState === 'welcome') {
                    return `<div class="min-h-screen bg-gradient-to-br from-purple-900 to-indigo-900 text-white flex items-center justify-center p-12">
                    <div class="text-center">
                    <div class="text-9xl mb-8">‚úì</div>
                    <h1 class="text-5xl font-bold font-oswald mb-4">P≈ôipojeni!<br>Connessi!</h1>
                    <p class="text-2xl text-gray-300">ƒåek√°me na ostatn√≠ t√Ωmy a HOST...<br>Aspettiamo le altre squadre e l'HOST...</p>
                    </div></div>`;
                }
                
                if (d.gameState === 'countdown') {
                    return `<div class="min-h-screen bg-gradient-to-br from-red-900 to-yellow-900 text-white flex items-center justify-center p-12">
                    <div class="text-center">
                    <div class="text-9xl mb-8">‚è≥</div>
                    <h1 class="text-5xl font-bold font-oswald">Zaƒç√≠n√°me...<br>Cominciamo...</h1>
                    </div></div>`;
                }
                
                if (d.gameState === 'playing') {
                    if (!d.currentCategory) {
                        return `<div class="min-h-screen bg-gradient-to-br from-indigo-900 to-purple-900 text-white flex items-center justify-center p-12">
                        <div class="text-center">
                        <div class="text-9xl mb-8">üéØ</div>
                        <h1 class="text-5xl font-bold font-oswald">Vyberte kategorii...<br>Scegli la categoria...</h1>
                        </div></div>`;
                    }
                    
                    const cat = CATEGORIES.find(c => c.id === d.currentCategory);
                    const q = QUESTIONS[d.currentCategory][d.currentLevel];
                    const isLevel1 = d.currentLevel === 1;
                    const answerKey = `${this.teamId}-${d.currentLevel}-${d.currentCategory}`;
                    const hasAnswered = d.answers && d.answers[answerKey] !== undefined;
                    
                    if (cat.type === 'buzzer') {
                        const canBuzz = !d.buzzer;
                        return `<div class="min-h-screen bg-gradient-to-br from-pink-900 to-purple-900 text-white p-8"><div class="max-w-3xl mx-auto">
                        <div class="text-center mb-8">
                        <div class="text-2xl font-bold bg-white/20 px-6 py-3 rounded-full inline-block">LEVEL ${d.currentLevel}/5</div>
                        <div class="text-3xl font-bold mt-4">${cat.icon} ${cat.name}</div>
                        <div class="text-xl font-bold mt-2 text-yellow-400">üíé ${this.calculatePoints()}</div>
                        </div>
                        <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-8 mb-8">
                        <div class="text-2xl text-center mb-8"><p class="mb-3">${q.cz}</p><p class="text-blue-200">${q.it}</p></div>
                        ${q.image ? `<img src="${q.image}" style="max-width: 400px; max-height: 400px;" class="mx-auto rounded-lg mb-8">` : `<div class="text-9xl text-center mb-8">${q.visual}</div>`}
                        </div>
                        ${canBuzz ? `
                        <button onclick="app.pressBuzzer('${this.teamId}')" class="w-full bg-gradient-to-r from-red-500 to-orange-500 text-white text-4xl font-bold py-12 rounded-2xl hover:scale-105 transition-all shadow-2xl font-oswald animate-pulse">
                        üîî BUZZER!
                        </button>` : `<div class="text-center text-2xl text-yellow-300">ƒåek√°me na buzzer...<br>Aspettiamo il buzzer...</div>`}
                        </div></div>`;
                    } else {
                        if (hasAnswered) {
                            return `<div class="min-h-screen bg-gradient-to-br from-indigo-900 to-pink-900 text-white flex items-center justify-center p-12">
                            <div class="text-center">
                            <div class="text-9xl mb-8">‚úì</div>
                            <h1 class="text-5xl font-bold font-oswald">Odpovƒõƒè odesl√°na!<br>Risposta inviata!</h1>
                            </div></div>`;
                        }
                        
                        let timerColor = 'text-green-400';
                        if (d.timer <= 20) timerColor = 'text-red-400';
                        else if (d.timer <= 40) timerColor = 'text-yellow-400';
                        
                        return `<div class="min-h-screen bg-gradient-to-br from-indigo-900 to-pink-900 text-white p-8"><div class="max-w-3xl mx-auto">
                        <div class="text-center mb-8">
                        <div class="text-2xl font-bold bg-white/20 px-6 py-3 rounded-full inline-block mb-4">LEVEL ${d.currentLevel}/5</div>
                        <div class="text-3xl font-bold">${cat.icon} ${cat.name}</div>
                        <div class="text-xl font-bold mt-2 text-yellow-400">üíé ${this.calculatePoints()}</div>
                        ${!isLevel1 && d.timerActive ? `<div class="text-5xl font-bold ${timerColor} mt-4">‚è±Ô∏è ${d.timer}s</div>` : ''}
                        </div>
                        
                        <div class="bg-white/10 backdrop-blur-lg rounded-3xl p-8 mb-8">
                        <div class="text-2xl text-center mb-8"><p class="mb-3">${q.cz}</p><p class="text-blue-200">${q.it}</p></div>
                        
                        ${!isLevel1 && d.hintsShown > 0 && q.hints ? `<div class="bg-yellow-400/20 border-2 border-yellow-400 rounded-xl p-4 mb-4 text-xl text-yellow-300">
                        ${q.hints[d.hintsShown-1].type === 'image' ? `<img src="${q.hints[d.hintsShown-1].content}" class="mx-auto rounded-lg" style="max-width: 200px; max-height: 200px;" alt="N√°povƒõda">` : q.hints[d.hintsShown-1].content}
                        </div>` : ''}
                        
                        <div class="grid grid-cols-1 gap-4">
                        ${q.answers.map((a,i)=>`<button onclick="app.submitAnswer('${this.teamId}',${i})" class="bg-gradient-to-r from-blue-500 to-purple-600 text-xl font-bold py-6 px-6 rounded-xl hover:scale-105 transition-all">
                        <span class="text-yellow-400 text-2xl mr-3">${String.fromCharCode(65+i)}</span>${a}
                        </button>`).join('')}
                        </div>
                        </div>
                        </div></div>`;
                    }
                }
                
                if (d.gameState === 'levelEnd') {
                    return `<div class="min-h-screen bg-gradient-to-br from-green-900 to-blue-900 text-white flex items-center justify-center p-12">
                    <div class="text-center">
                    <div class="text-9xl mb-8">‚è≥</div>
                    <h1 class="text-5xl font-bold font-oswald">ƒåek√°me na dal≈°√≠ level...<br>Aspettiamo il prossimo livello...</h1>
                    </div></div>`;
                }
                
                if (d.gameState === 'finished') {
                    // Sort teams by score
                    const teams = [
                        { id: 'team1', ...d.teams.team1 },
                        { id: 'team2', ...d.teams.team2 },
                        { id: 'team3', ...d.teams.team3 }
                    ].sort((a, b) => b.score - a.score);
                    
                    const first = teams[0];
                    const second = teams[1];
                    const third = teams[2];
                    
                    return `<div class="min-h-screen bg-gradient-to-br from-yellow-900 to-orange-900 text-white flex items-center justify-center p-8">
                    <div class="max-w-4xl w-full text-center">
                    <div class="text-9xl mb-6">üèÜ</div>
                    <h1 class="text-5xl font-bold mb-6 font-oswald">HRA SKONƒåILA!</h1>
                    <h2 class="text-3xl font-bold mb-8 text-yellow-300">üéâ ${first.name} üéâ</h2>
                    
                    <div class="flex items-end justify-center gap-4 mb-8">
                        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-4 w-32" style="height: 180px;">
                            <div class="text-4xl mb-2">ü•à</div>
                            <p class="text-lg font-bold mb-2">${second.name}</p>
                            <p class="text-4xl font-bold text-gray-300">${second.score}</p>
                        </div>
                        <div class="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl p-6 w-40" style="height: 240px;">
                            <div class="text-6xl mb-2">ü•á</div>
                            <p class="text-xl font-bold mb-2 text-gray-900">${first.name}</p>
                            <p class="text-5xl font-bold text-gray-900">${first.score}</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-4 w-32" style="height: 150px;">
                            <div class="text-3xl mb-2">ü•â</div>
                            <p class="text-lg font-bold mb-2">${third.name}</p>
                            <p class="text-4xl font-bold text-amber-600">${third.score}</p>
                        </div>
                    </div>
                    <p class="text-xl text-gray-300 mt-6">Gratulujeme! üéä<br>Congratulazioni! üéä</p>
                    </div></div>`;
                }
            }
        }

        app = new QuizApp();
        
        }); // End of window.load event
    </script>
</body>
</html>